---

copyright:
  years: 2016, 2017
lastupdated: "2017-02-21"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:screen: .screen}
{:pre: .pre}

# OpenWhisk アセットに対するアノテーション

OpenWhisk のアクション、トリガー、ルール、およびパッケージ (包括的にアセットと呼ばれます) を`アノテーション`で装飾できます。名前を定義する`キー`および値を定義する`値`を持つパラメーターのように、アノテーションはアセットに付加されます。`--annotation` または省略形の `-a` を介してコマンド・ライン・インターフェース (CLI) から設定するのが便利です。
{: shortdesc}

論理的根拠: アノテーションが追加されたのは、基礎にあるアセット・スキーマに変更を加えずに実験を行えるようにするためです。この文書を作成するまでは、どういった`アノテーション`が許可されるのかを意図的に定義していませんでした。しかし、アノテーションの使用が頻繁になり、意味的な変更を開示するようになったため、ようやくアノテーションについての文書化を開始したことは有意義です。

これまでに最も普及しているアノテーションの用途は、アクションおよびパッケージを記述することです。OpenWhisk カタログに載っている多くのパッケージにアノテーションが付いていて、例えば、パッケージのアクションが提供する機能、どのパラメーターがパッケージのバインド時に必要なのか、どれが起動時パラメーターなのか、パラメーターは秘密 (例: パスワード) なのかどうかなどが説明されています。これらは必要に応じて (例えば、UI 統合を可能にするために) 開発されました。

入力引数を変更せずにそのまま返す `echo` アクション (例: `function main(args) { return args }`) に対する一連のアノテーションの例を以下に示します。このアクションは、例えばシーケンスまたはルールの一部として、入力パラメーターをログに記録する場合などに有用です。

```
wsk action create echo echo.js \
    -a description 'An action which returns its input. Useful for logging input to enable debug/replay.' \
    -a parameters  '[{ "required":false, "description": "Any JSON entity" }]' \
    -a sampleInput  '{ "msg": "Five fuzzy felines"}' \
    -a sampleOutput '{ "msg": "Five fuzzy felines"}'
```
{: pre}

パッケージを記述するために使用したアノテーションは次のとおりです。

- `description`: パッケージの簡潔な説明
- `parameters`: パッケージを有効範囲とするパラメーターを説明する配列 (下にもっと詳しく記述されています)

同様に、アクションについては次のとおりです。 

- `description`: アクションの簡潔な説明
- `parameters`: アクションの実行に必要なパラメーターを説明する配列
- `sampleInput`: 典型的な値を使用して入力スキーマを示す例
- `sampleOutput`: 出力スキーマを示す例 (通常は `sampleInput` に対する例)

パラメーターを記述するために使用したアノテーションは次のとおりです。

- `name`: パラメーターの名前
- `description`: パラメーターの簡潔な説明
- `doclink`: パラメーターに関する詳しい文書へのリンク (例えば、OAuth トークンなどに有用) 
- `required`: 必須パラメーターの場合は true、オプション・パラメーターの場合は false 
- `bindTime`: パッケージがバインドされるときにパラメーターの指定が必要な場合は true 
- `type`: パラメーターのタイプ、`password` または `array` のいずれか (もっと広範囲に使用可能)

アノテーションはチェック*されません*。したがって、例えば、2 つのアクションを合成して 1 つのシーケンスにするのが正当かどうかを推測するためにアノテーションを使用することが考えられますが、このシステムはまだそれを行っていません。

## Web アクションに固有のアノテーション
{: #openwhisk_annotations_webactions}

最近、中核 API が新規フィーチャーで拡張されました。これらのフィーチャーにパッケージおよびアクションが参加できるようにするため、意味的に重要な以下の新しいアノテーションが導入されました。これらのアノテーションは、作用するためには明示的に `true` に設定される必要があります。値を `true` から `false` に変更すると、付加されたアセットは新規 API から除外されます。これらのアノテーションには、システム内でそれ以外の意味はありません。アノテーションは次のとおりです。

- `final`: アクションにのみ適用されます。既に定義されたアクション・パラメーターのすべてを変更不可能にします。このアノテーションが付けられたアクションのパラメーターは、それを包含するパッケージまたはアクション定義を通していったん値が定義されると、起動時パラメーターでオーバーライドすることはできません。
- `web-export`: アクションにのみ適用されます。指定されている場合、対応するアクションは認証*なしで* REST 呼び出しでアクセス可能になります。これらは、例えばブラウザーから OpenWhisk アクションを使用することを許可するため、[*Web アクション*](openwhisk_webactions.html) と呼ばれます。Web アクションの*所有者*はシステムでそのアクションを実行するコストを負うことに注意することが重要です (つまり、アクションの*所有者*は、アクティベーション・レコードも所有します)。
- `require-whisk-auth`: アクションに適用されます。アクションに `web-export` アノテーションが付いており、かつこのアノテーションが `true` である場合、経路は認証済みサブジェクトにのみアクセス可能です。Web アクションの*所有者*はシステムでそのアクションを実行するコストを負うことに注意することが重要です (つまり、アクションの*所有者*は、アクティベーション・レコードも所有します)。
- `raw-http`: `web-export` アノテーションが存在するアクションにのみ適用されます。存在する場合、HTTP 要求の照会パラメーターと本体パラメーターが、予約済みプロパティーとしてアクションに渡されます。

